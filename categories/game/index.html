<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>game &#183; Hrvoje's Blog</title><meta name=description content="It's only ones and zeros"><meta name=generator content="Hugo 0.74.2"><meta name=twitter:card content="summary"><meta name=twitter:title content="game &#183; Hrvoje's Blog"><meta name=twitter:description content="It's only ones and zeros"><meta property="og:type" content="article"><meta property="og:title" content="game &#183; Hrvoje's Blog"><meta property="og:description" content="It's only ones and zeros"><link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700" rel=stylesheet type=text/css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css><link rel=stylesheet href=https://blog.hrvoje.org/css/all.min.css><link rel=stylesheet href=https://blog.hrvoje.org/css/syntax.css><link rel=alternate type=application/rss+xml title="Hrvoje's Blog" href=https://blog.hrvoje.org/index.xml></head><body><div id=layout class=pure-g><div class="sidebar pure-u-1 pure-u-md-1-6"><div class=header><hgroup><h1 class=brand-title><a href=https://blog.hrvoje.org/>Hrvoje's Blog</a></h1><h2 class=brand-tagline>It's only ones and zeros</h2></hgroup><nav class=nav><ul class=nav-list><li class=nav-item><a class=pure-button href=https://www.linkedin.com/in/hcavrak><i class=icon-linkedin></i></a></li><li class=nav-item><a class=pure-button href=https://twitter.com/hcavrak><i class=icon-twitter></i></a></li><li class=nav-item><a class=pure-button href=https://github.com/hrvach><i class=icon-github></i></a></li><li class=nav-item><a class=pure-button href=https://blog.hrvoje.org/index.xml><i class=icon-rss></i></a></li></ul></nav></div></div><div class="content pure-u-1 pure-u-md-3-4"><div><div class=posts><h1 class=content-subhead>20 Sep 2014, 01:11</h1><section class=post><header class=post-header><a href=https://blog.hrvoje.org/2014/09/a-simple-2048-clone-in-python/ class=post-title>A simple 2048 clone in Python</a><p class=post-meta>under
<a class="post-category post-category-python" href=https://blog.hrvoje.org/categories/python>python</a>
<a class="post-category post-category-programming" href=https://blog.hrvoje.org/categories/programming>programming</a>
<a class="post-category post-category-game" href=https://blog.hrvoje.org/categories/game>game</a></p></header><div class=post-description><p>Every now and then a viral game shows up. It is difficult to name a particular quality which makes a game popular, but most people would probably describe it as <em>addictive</em>. 2048 is just that, despite its remarkable simplicity.</p><p>Soon, I started wondering how many lines of code would it take to write it and what are the bare essentials of the game, and tried writing my own version. To keep things short, movements are implemented in a single direction only. For the rest of the moves to work you have to rotate the matrix a few times first, perform the move and rotate it some more to return to your starting point. Not ideal, but simple it is. Game over detect simply checks if movement in any direction affects the board.</p><p>Tile creation needed to be short, so a list of zero-valued matrix elements&rsquo; coordinates was made, one picked out at random and a 2 or 4 placed there. To color the backgrounds differently, its background color is derived from its value. A dictionary could have been used as well, but it would be slightly longer.</p><p>That&rsquo;s pretty much it - no score, no menu, no restart, no keypress error handling&mldr; just the bare essentials, but - it works. And it&rsquo;s kind of fun, too!</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>random</span><span class=o>,</span><span class=nn>Tkinter</span>
<span class=k>def</span> <span class=nf>shift</span><span class=p>(</span><span class=n>c</span><span class=p>):</span> <span class=k>return</span> <span class=nb>list</span><span class=p>([</span><span class=n>i</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>c</span> <span class=k>if</span> <span class=n>i</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>c</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>
<span class=k>def</span> <span class=nf>sms</span><span class=p>(</span><span class=n>l</span><span class=p>):</span>
        <span class=n>l</span><span class=o>=</span><span class=n>shift</span><span class=p>(</span><span class=n>l</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>l</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>):</span>
                <span class=k>if</span> <span class=n>l</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>==</span><span class=n>l</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span> <span class=n>l</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>l</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>2</span><span class=o>*</span><span class=n>l</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=mi>0</span>
        <span class=k>return</span> <span class=n>shift</span><span class=p>(</span><span class=n>l</span><span class=p>)</span>
<span class=k>class</span> <span class=nc>igra</span><span class=p>(</span><span class=n>Tkinter</span><span class=o>.</span><span class=n>Tk</span><span class=p>):</span>
        <span class=n>b</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>],[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>],[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>],[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>]]</span>
        <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>parent</span><span class=p>):</span>
                <span class=n>Tkinter</span><span class=o>.</span><span class=n>Tk</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>parent</span><span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>parent</span> <span class=o>=</span> <span class=n>parent</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>grid</span><span class=p>()</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>bl</span> <span class=o>=</span> <span class=p>[</span><span class=n>Tkinter</span><span class=o>.</span><span class=n>Button</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>height</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=n>Tkinter</span><span class=o>.</span><span class=n>DISABLED</span><span class=p>,</span> <span class=n>font</span><span class=o>=</span><span class=p>(</span><span class=s2>&#34;Helvetica&#34;</span><span class=p>,</span> <span class=mi>24</span><span class=p>))</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>)]</span>
                <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span> <span class=bp>self</span><span class=o>.</span><span class=n>bl</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>row</span><span class=o>=</span><span class=n>i</span><span class=o>//</span><span class=mi>4</span><span class=p>,</span> <span class=n>column</span><span class=o>=</span><span class=n>i</span><span class=o>%</span><span class=mi>4</span><span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>dodaj_novu</span><span class=p>()</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>bind_all</span><span class=p>(</span><span class=s1>&#39;&lt;Key&gt;&#39;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>key</span><span class=p>)</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>mainloop</span><span class=p>()</span>
        <span class=k>def</span> <span class=nf>rot</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>zip</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>])))</span>
        <span class=k>def</span> <span class=nf>move</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
                <span class=n>diff</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[:]</span>
                <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span> <span class=bp>self</span><span class=o>.</span><span class=n>rot</span><span class=p>()</span>
                <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>sms</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
                <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=o>-</span><span class=n>n</span><span class=p>):</span> <span class=bp>self</span><span class=o>.</span><span class=n>rot</span><span class=p>()</span>
                <span class=k>return</span> <span class=mi>1</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>!=</span> <span class=n>diff</span> <span class=k>else</span> <span class=mi>0</span>
        <span class=k>def</span> <span class=nf>dodaj_novu</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
                <span class=n>k</span> <span class=o>=</span> <span class=p>[(</span><span class=n>i</span><span class=o>//</span><span class=mi>4</span><span class=p>,</span> <span class=n>i</span><span class=o>%</span><span class=mi>4</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span><span class=n>j</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>sum</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=p>[]))</span> <span class=k>if</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>0</span><span class=p>][</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>sum</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=p>[])</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)]</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>k</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=n>k</span><span class=p>[</span><span class=mi>1</span><span class=p>]]</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span><span class=o>*</span><span class=mi>2</span>
                <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span>
                        <span class=n>d</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=o>//</span><span class=mi>4</span><span class=p>][</span><span class=n>i</span><span class=o>%</span><span class=mi>4</span><span class=p>]</span>
                        <span class=bp>self</span><span class=o>.</span><span class=n>bl</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>config</span><span class=p>(</span><span class=n>text</span><span class=o>=</span><span class=n>d</span> <span class=k>if</span> <span class=n>d</span> <span class=k>else</span> <span class=s1>&#39; &#39;</span><span class=p>,</span> <span class=n>bg</span><span class=o>=</span><span class=s1>&#39;#</span><span class=si>%06x</span><span class=s1>&#39;</span><span class=o>%</span> <span class=p>((</span><span class=mi>2</span><span class=o>**</span><span class=mi>24</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=n>d</span><span class=o>*</span><span class=mi>1500</span><span class=p>)</span> <span class=p>))</span>
        <span class=k>def</span> <span class=nf>key</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>):</span>
                <span class=n>direction</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;Left&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;Down&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;Right&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;Up&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>}</span>
                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>move</span><span class=p>(</span><span class=n>direction</span><span class=p>[</span><span class=n>event</span><span class=o>.</span><span class=n>keysym</span><span class=p>]):</span> <span class=bp>self</span><span class=o>.</span><span class=n>dodaj_novu</span><span class=p>()</span>
                <span class=n>p</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[:]</span>
                <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
                        <span class=bp>self</span><span class=o>.</span><span class=n>move</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
                        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>!=</span> <span class=n>p</span><span class=p>:</span>
                                <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=n>p</span><span class=p>[:]</span>
                                <span class=k>return</span>
                <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>16</span><span class=p>):</span> <span class=bp>self</span><span class=o>.</span><span class=n>bl</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>config</span><span class=p>(</span><span class=n>bg</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>text</span><span class=o>=</span><span class=s1>&#39;:(&#39;</span><span class=p>)</span>
<span class=n>a</span> <span class=o>=</span> <span class=n>igra</span><span class=p>(</span><span class=bp>None</span><span class=p>)</span>
</code></pre></div><p>&mldr;and it looks like this:</p><p><img src=/img/2048.png alt="2048 game"></p></div></section></div><div class=footer><div class="pure-menu pure-menu-horizontal pure-menu-open"><ul><li>Powered by <a class=hugo href=https://gohugo.io/ target=_blank>hugo</a></li></ul></div></div></div></div></div><script></script></body></html>